== Module 2: Using Red Hat Dev Spaces
:navtitle: Using Red Hat Dev Spaces

GIT Repository: https://github.com/pkredhat/nb-workshop/tree/module2-python

Inside your workspace is a very simple Python application built using Flask. The application returns a “hello world” message based on the language selected using a country code.

- The country is specified using a 2-letter country code.  
  Example: `countryCode=IT` returns `ciao mondo` (IT = Italy)
- All translations are defined in the `translate.json` file.
- The message also includes a timestamp.

== Fix the Application

Perform the following tasks to fix and improve the application:

. Install the required dependencies:
+
[source,sh]
----
pip install -r requirements.txt
----

. Set the following environment variables (needed for `pytest` to work):
+
[source,sh]
----
FLASK_APP=app.py
FLASK_ENV=development
PYTHONPATH=.
----

. Format the hello world timestamp:
  * Use Eastern Standard Time (New York)
  * Display format: `{HH:MM MM/DD/YYYY}`

. Write a test case that verifies:
  * Timezone correctness
  * New date format correctness

. In `/routes/main.py`, create a new route:
  * Endpoint: `/api/query`
  * Method: `GET`
  * Append a query string to accept a `countryCode` parameter (e.g., `/api/query?countryCode=en`)
  * Return the correct greeting based on the given country code

== Final Compilation

. Run the Flask app using the following command:
+
[source,sh]
----
flask run --host=0.0.0.0 --port=8080
----

. Open a second terminal and run `pytest` to ensure test cases pass:
+
[source,sh]
----
./pytest
----

== Bonus Tasks

* Add a new endpoint `/api/magic8`:
  * Returns a random country code
  * Returns the corresponding greeting (like a magic 8-ball)

* Write additional tests for:
  * `/api/query`
  * `/api/magic8`

* Add an additional `/api/query` endpoint using `POST` instead of `GET`.
  * Use `curl` to test the POST functionality.

* Add styling and HTML enhancements:
  ** Attach a simple stylesheet to change the background color to blue
  ** Wrap the "hello world" message in a `<blockquote>` tag
  ** Use `render_template()` to serve HTML
  ** Place your stylesheet in a `/static` folder
  ** Place your HTML files in a `/templates` folder

== Easter Eggs!

* There is an easter egg in the code.
* Be thorough and review the code carefully.
* Try to find and solve the Golden Egg! (Hint: it’s a two-step process)

== Takeaways

* First look at **Red Hat Dev Spaces**
* Set up a Python Flask application inside Dev Spaces
* Leveraged Dev Spaces' quick container-based app builds
* Utilized environment variables within your app
* Created and accessed your first OpenShift service and route
